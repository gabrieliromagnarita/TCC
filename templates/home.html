<HTML lang="pt-br">
    <HEAD>
        <title>home</title>
        <link rel="stylesheet" href="static/estilo.css" type="text/css">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=1240,shrink-to-fit=no">
    </HEAD>
    <BODY>
        <div id="header">
            <img src="static/imagens/logo-face-a-face.png" id="logo-face-a-face">
            <div id="icons">
                <img src="static/imagens/search-bar-icon.png" id="search-bar-icon">
                <a href="/cadastro-render"><img src="static/imagens/user-icon.png" id="user-icon"></a>
                <a href=""><img src="static/imagens/shopping-cart-icon.png" id="shopping-cart-icon"></a>
            </div>
        </div>
        <div id="sub-header">
            <a href="/historia-render" class="header-text historia">HISTÓRIA</a> 
            <a href="/home-render" class="header-text home">HOME</a> 
            <a href="/faq-render" class="header-text faq">FAQ</a>
        </div>
        <div id="content-home">
            <div id="home-left">
                <details>
                    <summary data-categoria="cabelos">CABELOS</summary>
                    <p><a href="#"  data-categoria="a">a</a></p>
                    <p><a href="#"  data-categoria="a">a</a></p>
                </details>
                <details>
                    <summary data-categoria="unhas">UNHAS</summary>
                    <p><a href="#"  data-categoria="b">a</a></p>
                    <p><a href="#"  data-categoria="b">a</a></p>
                </details>
                <details>
                    <summary data-categoria="maquiagem">MAQUIAGEM</summary>
                    <p><a href="#"  data-categoria="batom">BATONS</a></p>
                    <p><a href="#" data-categoria="bases">BASES</a></p>
                    <p><a href="#" data-categoria="corretivos">CORRETIVOS</a></p>
                    <p><a href="#" data-categoria="sombras">SOMBRAS</a></p>
                    <p><a href="#" data-categoria="pó">PÓ</a></p>
                    <p><a href="#" data-categoria="lápis">LÁPIS</a></p>
                    <p><a href="#" data-categoria="rímel">RÍMEL</a></p>
                </details>
                <details>
                    <summary data-categoria="skincare">SKINCARE</summary>
                    <p><a href="#"  data-categoria="a">a</a></p>
                    <p><a href="#"  data-categoria="a">a</a></p>
                </details>
                <details>
                    <summary data-categoria="corpo">CORPO</summary>
                    <p><a href="#"  data-categoria="a">a</a></p>
                    <p><a href="#"  data-categoria="a">a</a></p>
                </details>
                <details>
                    <summary data-categoria="dermocosméticos">DERMOCOSMÉTICOS</summary>
                    <p><a href="#"  data-categoria="a">a</a></p>
                    <p><a href="#"  data-categoria="a">a</a></p>
                </details>
                <details>
                    <summary data-categoria="acessórios">ACESSÓRIOS</summary>
                    <p><a href="#"  data-categoria="a">a</a></p>
                    <p><a href="#"  data-categoria="a">a</a></p>
                </details>
            </div>
            <div id="home-right">
                {% if produtos %}
                    {% for i in produtos %}
                        <div class="produtos-grid">
                            <img src="{% if i.foto1 %}{{ url_for('static', filename=i.foto1) }}{% else %}{{ url_for('static', filename='imagens/placeholder.png') }}{% endif %}" class="produto-img">
                            <p class="produto-nome">{{ i.nome }}</p>
                            <p class="produto-preco">R${{ "%.2f"|format(i.preco) if i.preco else "0,00" }}</p>
                            <button class="btn-comprar-home">COMPRAR</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>Nenhum produto encontrado.</p>
                {% endif %}
            </div>
        </div>
        <script>
            document.addEventListener("DOMContentLoaded", function(){
                const allDetails = document.querySelectorAll("details")
        
                allDetails.forEach((detail) => {
                    const summary = detail.querySelector("summary");
                    summary.addEventListener("click", e => {
                        e.preventDefault();
        
                        allDetails.forEach(d => {if (d !== detail) d.removeAttribute("open");});
                        detail.setAttribute("open", "");
        
                        const cat = summary.getAttribute("data-categoria");
                        if (cat) {
                            window.location.href = `/home-render?categoria=${encodeURIComponent(cat)}`;
                        }
                    });
                    detail.querySelectorAll("a[data-categoria]").forEach(link => {
                        link.addEventListener("click", e => {
                            e.preventDefault();
        
                            const sub = link.getAttribute("data-categoria");
                            if (sub){
                                window.location.href = `/home-render?categoria=${encodeURIComponent(sub)}`;
                            }
                        });
                    });
                });
                const urlParams = new URLSearchParams(window.location.search);
                const catAtual = urlParams.get("categoria");
                allDetails.forEach(detail => {
                    const sum = detail.querySelector("summary");
                    const sumCat = sum ? sum.getAttribute("data-categoria"): null;
                    if (sumCat === catAtual){
                        detail.setAttribute("open", "");
                    }
                    else{
                        const links = detail.querySelectorAll("a[data-categoria]");
                        links.forEach(link => {
                            if (link.getAttribute("data-categoria") === catAtual){
                                detail.setAttribute("open", "")
                            }
                        })
                    }
                });
            });
        </script>
    </BODY>
</HTML>

