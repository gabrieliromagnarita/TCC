<HTML lang="pt-br">
    <HEAD>
        <title>home</title>
        <link rel="stylesheet" href="static/estilo.css" type="text/css">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=1240,shrink-to-fit=no">
    </HEAD>
    <BODY>
        <div id="header">
            <img src="static/imagens/logo-face-a-face.png" id="logo-face-a-face">
            <div id="icons">
                <img src="static/imagens/search-bar-icon.png" id="search-bar-icon">
                <a href="/cadastro-render"><img src="static/imagens/user-icon.png" id="user-icon"></a>
                <a href=""><img src="static/imagens/shopping-cart-icon.png" id="shopping-cart-icon"></a>
            </div>
        </div>
        <div id="sub-header">
            <a href="/historia-render" class="header-text historia">HISTÓRIA</a> 
            <a href="/home-render" class="header-text home">HOME</a> 
            <a href="/faq-render" class="header-text faq">FAQ</a>
        </div>
        <div id="content-home">
            <div id="home-left">
                {% for categoria, subcategorias in categorias_dict.items() %}
                <div class="categoria-home">
                    <button class="btn-categoria" onclick="toggleSubcats('{{categoria}}')">
                        <li><a href="">CABELOS</a></li>
                        <li><a href="">UNHAS</a></li>
                        <li><a href="">MAQUIAGEM</a></li>
                        <li><a href="">SKINCARE</a></li>
                        <li><a href="">CORPO</a></li>
                        <li><a href="">DERMOCOSMÉTICOS</a></li>
                        <li><a href="">ACESSÓRIOS</a></li>
                    </button>
                </div>
                <div class="subcategoria-home" id="subcategoria-{{categoria}}" style="display: none;">
                    {% for i in subcategoria %}
                        <button class="btn-sub" onclick="filtrarProdutos('{{categoria}}', '{{sub}}')">
                            {{ sub }}
                        </button>
                    {% endfor %}
                </div>
                {% endfor %}
            </div>
            <div id="home-right">
                {% if produtos %}
                    {% for i in produtos %}
                        <div class="produtos-grid">
                            <img src="{% if i.foto %}{{ url_for('static', filename=i.foto) }}{% else %}{{ url_for('static', filename='imagens/placeholder.png') }}{% endif %}" class="produto-img">
                            <p class="produto-nome">{{ i.nome }}</p>
                            <p class="produto-preco">R${{ "%.2f"|format(i.preco) if i.preco else "0,00" }}</p>
                            <button class="btn-comprar-home">COMPRAR</button>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>Nenhum produto encontrado.</p>
                {% endif %}
            </div>
        </div>
    </BODY>
</HTML>

<script>
    function toggleSubcats(categoria){
        let el = document.getElementById("subcategoria-"+categoria);
        el.style.display = (el.style.display === "none" ? "block": "none");
    }
    function filtrarProdutos(categoria, subcategoria){
        fetch(`/home-render?categoria=${encodeURIComponent(categoria)}&subcategoria=${encodeURIComponent(subcategoria)}`)
        .then(res => res.text())
        .then(htmll => {
            document.getElementById("home-right").innerHTML= html;
        });
    }
</script>